--- 
title: "Experimentology"
subtitle: "An Open Science Approach to Experimental Psychology Methods"
author: "Michael C. Frank, Mika Braginsky, Julie Cachia, Nicholas Coles, Tom Hardwicke, Robert Hawkins, Maya Mathur, and Rondeline Williams"

site: bookdown::bookdown_site
documentclass: book
classoption: twoside,symmetric

bibliography: experimentology.bib
csl: apa.csl
link-citations: yes
---

# {.unlisted .unnumbered}

Placeholder


## Introduction {-}
## What this book is and isn't about {-}
## How to use this book {-}
## Themes {-}
## What is open science, and why plan a book around it? {-}
## The software toolkit of the behavioral researcher (and of this book) {-}

<!--chapter:end:index.Rmd-->


# (PART) Preliminaries {-}
# Experiments and theories {#intro}

Placeholder


## What is an experiment, and why would you do one?
### Causal inference
### Randomization
## What is a theory? 
### Psychological theories
### Theory testing: Popper, Kuhn, and Lakatos, oh my!
### Models and theories 
## Theory testing in psychology
### "Risky" and informative tests
### Theories, frameworks, and paradigms
### Who (and what) are we theorizing about? 
## Experiments and Theories: Chapter summary

<!--chapter:end:001-intro.Rmd-->


# Replication and reproducibility  {#replication}

Placeholder


## Reproducibility
## Replication
### Conceptual frameworks for replication
### The meta-science of replication
## Causes of replication failure
### Context, moderators, and expertise
### P-hacking and publication bias
## Replication and theory building
### Reciprocity between replication and theory
### Necessary but not sufficient
### A "replication crisis"?

<!--chapter:end:002-replication.Rmd-->


# Ethics {#ethics}

Placeholder


## Ethical frameworks
### Consequentialist theories
### Deontological and virtue-based approaches
### Deontological principles for research
## Ethical responsibilities to research participants
### Institutional review boards
### Informed consent
### Debriefing participants
### Special considerations for vulnerable populations
## Ethical responsibilities in analysis and reporting of research 
## Ethical responsibilities to the broader scientific community
## Chapter summary: Ethics 

<!--chapter:end:003-ethics.Rmd-->


# (PART) Statistics {-}
# Estimation {#estimation}

Placeholder


## Estimating a quantity
### Maximum likelihood estimation
### Estimating variation in ratings
### Bayesian estimation
## Estimating and comparing effects
### Estimating the treatment effect 
### Measures of effect size
### Pros and cons of standardizing effect sizes
## Summary: Estimation

<!--chapter:end:004-estimation.Rmd-->


# Inference {#inference}

Placeholder


## Sampling variation
### Standard errors
### The central limit theorem
## From variation to inference
## Making inferences
### Bayes Factors
### *p*-values
### The Neyman-Pearson approach
## Inference and its discontents
### Problems with the interpretation of *p*
### Philosophical (and empirical) views of probability
## Estimating precision
### Confidence intervals
### Confidence in confidence intervals? 
## Chapter summary: Inference

<!--chapter:end:005-inference.Rmd-->


# Models {#models} 

Placeholder


## Inference and estimation for two-group designs
### Simple models of between-group differences
## Covariates

<!--chapter:end:006-models.Rmd-->


# (PART) Design and Planning {-}
# Measurement {#measurement}

Placeholder


## Reliability
### Measurement scales
### Reliability is relative
### Practical advice for computing reliability
## Validity
## How to select a good measure?
### What to measure? 
### Survey measures
## The temptation to measure lots of things
## Chapter summary

<!--chapter:end:007-measurement.Rmd-->


# Design of experiments {#design}

Placeholder


## Manipulation validity
### Threats to manipulation validity
### Confounding
### Removing nuisance confounds
## How to design a manipulation to test a theory.
### Design concepts
### Connecting with theory

<!--chapter:end:008-design.Rmd-->


# Sampling {#sampling}

Placeholder



<!--chapter:end:009-sampling.Rmd-->

```{r include=FALSE, cache=FALSE}
library(tidyverse)
library(glue)
library(knitr)
library(shiny)
library(metafor)
require(BayesFactor)
require(papaja)

opts_chunk$set(
  message = FALSE,
  warning = FALSE,
  error = FALSE,
  comment = "#>",
  collapse = TRUE,
  cache = TRUE,
  echo = FALSE,
  cache.lazy = FALSE,
  dev = "png",
  dpi = 300,
  out.width = "\\linewidth"
)
kable <- function(...) knitr::kable(..., booktabs = TRUE, linesep = "")

set.seed(42)

.font <- "Source Sans Pro"
theme_set(theme_bw(base_size = 14, base_family = .font))
theme_update(panel.grid = ggplot2::element_blank(),
             strip.background = ggplot2::element_blank(),
             legend.key = ggplot2::element_blank(),
             panel.border = ggplot2::element_blank(),
             axis.line = ggplot2::element_line(),
             strip.text = ggplot2::element_text(face = "bold"))
.grey <- "grey70"
.refline <- "dotted"
.coef_line <- element_line(colour = .grey, size = 0.1)

.pal <- ggthemes::ptol_pal
.scale_colour_discrete <- ggthemes::scale_colour_ptol
.scale_color_discrete <- .scale_colour_discrete
.scale_fill_discrete <- ggthemes::scale_fill_ptol

.scale_colour_continuous <- viridis::scale_colour_viridis
.scale_color_continuous <- .scale_colour_continuous
.scale_fill_continuous <- viridis::scale_fill_viridis

.scale_colour_numerous <- scale_colour_discrete
.scale_color_numerous <- .scale_colour_numerous
.scale_fill_numerous <- scale_fill_discrete

# from https://bookdown.org/yihui/rmarkdown-cookbook/font-color.html
colorize <- function(x, color) {
  if (knitr::is_latex_output()) {
    sprintf("\\textcolor{%s}{%s}", color, x)
  } else if (knitr::is_html_output()) {
    sprintf("<span style='color: %s;'>%s</span>", color,
            x)
  } else x
}
```
# Preregistration {#prereg}

::: {.learning-goals}
🍎 Learning goals: 

- Recognize the dangers of researcher degrees of freedom in "the garden of forking paths"
- Understand the differences between exploratory and confirmatory modes of research
- Learn how preregistration and other tools can counter bias and help others to evaluate your work by increasing transparency

:::

> The first principle is that you must not fool yourself--and you are the easiest person to fool...After you've not fooled yourself, it's easy not to fool other scientists. You just have to be honest in a conventional way after that. 
>
> `r tufte::quote_footer('--- Richard Feynman [-@feynman1974]')`

This may surprise you coming from the authors of a textbook about research methods, but there is no single "correct" way to design and analyze an experiment[^1]. In fact, for most research decisions, there are many justifiable options. For example, will you stop data collection after 20, 200, or 2000 participants? Will you remove outlier values and how will you define them? Will you conduct subgroup analyses to see whether the results are affected by sex, or age, or some other factor? Consider a simplified, hypothetical case where you need to make five analysis decisions and have five justifiable options for each decision — this alone would result in 3125 (5^5) unique ways to analyze your data! In this chapter, we will find out why flexibility in the design, analysis, reporting, and interpretation of experiments (also referred to as "researcher degrees of freedom"), can lead to scientists fooling themselves and fooling each other. We will also learn about how preregistration (and other tools) can be used to protect our research from bias and provide the transparency that other scientists need to effectively evaluate our work.

[^1]: Though there are plenty of incorrect ways to design and analyse experiments and we hope we can help you to avoid these!

## Lost in a garden of forking paths

```{r forking-paths, fig.cap="Garden of forking paths (placeholder image I hacked together, replace with an illustration?)", fig.margin=TRUE}
knitr::include_graphics("images/prereg/forking-paths.png")
```

One way to visualize researcher degrees of freedom is as a vast decision tree or "garden of forking paths" (Figure \@ref(fig:forking-paths); @gelman2014). Each node represents a decision point and each branch represents a justifiable choice. Each unique pathway through the garden terminates in an individual result. Because scientific observations typically consist of both noise (random variation unique to this sample) and signal (regularities that will reoccur in other samples), some of these pathways will inevitably lead to results that are misleading (e.g., inflated effect sizes, exaggerated evidence, or false positives)[^2]. The more potential paths there are in the garden that you might explore, the higher the chance of encountering misleading results[^3]. Statisticians refer to this as a *multiplicity* problem. 

[^2]: The signal-to-noise ratio is worse in situations (alas, common in psychology) that involve small effect sizes, high variation, and large measurement errors [@ioannidis2005]. Researcher degrees of freedom may be constrained to some extent by strong theory [@oberauer2019], community norms, or replication studies, though these constraints may be more implicit than explicit, and still leave plenty of room for flexible decision-making.

[^3]: In frequentist terminology, you are increasing the chance of making a 'Type I error' or 'false positive' finding.

As noted in Chapter \@ref(inference), multiplicity can be addressed to some extent with statistical countermeasures, like the Bonferroni correction; however, these adjustment methods need to account for every path that you *could have* taken [@gelman2014; @degroot2014]. When you navigate the garden of forking paths *during data analysis*, it is easy to forget, or even be unaware of every path that you could have taken, so these methods can longer be used effectively. Additionally, when a researcher navigates the garden of forking paths during data analysis, their decisions can be biased because they are receiving feedback on how different choices affect the results (*results-dependent* decision making). If a researcher is seeking a particular kind of result (which is likely - see Box 1), then they are more likely to follow the branches that take them in that direction. You could think of this a bit like playing a game of hot!🔥 or cold!☃️. Each time the researcher reaches a decision point, they try one of the branches and get some feedback on how it affects the results. If the feedback is hot!🔥 (i.e., the result is in line with their preferences) then they take that branch. If the answer is cold!☃️, they try a different branch. If they reach the end of a complete pathway, and the results are cold!☃️, maybe they even retrace their steps and try some different branches earlier in the pathway. This strategy create a risk of bias[^4] because the results of the study are being systematically skewed towards the researcher's preferences[^5]. 

[^4]: We say "risk of bias" rather than just "bias" because in most scientific contexts, we do not have a known ground truth to compare the results to. So in any specific situation, we do not know the extent to which results-dependent analyses have actually biased the results.

[^5]: Another way to think of this is in terms of 'regression to the mean'. When a sample statistic is selected because it crosses some threshold (e.g., statistical significance), then it is more likely to provide a biased estimate that decreases upon subsequent measurement - in other words, it regresses to the mean.

In the most egregious cases, a researcher may try multiple pathways until they obtain a desirable result[^6] and then *selectively report* that result, neglecting to mention that they have tried several analysis strategies. You may remember an example of this when participants apparently became younger when they listened to "When I'm 64" by The Beatles in Chapter \@ref(ethics). Another nice example is when a group of enterprising researchers 'discovered' brain activity in a dead Atlantic Salmon (Figure \@ref(fig:salmon); @bennett2009).  Deliberately taking advantage of researcher degrees of freedom and selectively reporting results is known by various names, like p-hacking, cherry picking, data dredging, and it is unethical because it involves hiding highly relevant information. But you should also be aware that results-dependent analysis incurs a risk of bias even if the researcher doesn't explicitly try multiple pathways and honestly reports everything they did. For example, if each branch they took was hot!🔥, they may reach the end of the pathway with the result they desire without realizing that, had the results been different, they would have followed other pathways [@gelman2014; @degroot2014]. Its surprisingly easy to convince yourself after the fact that you made the decisions you did for principled reasons that had nothing to do with the results (see 'motivated reasoning', Box 1). In sum, engaging in results-dependent analysis increases the chances that you will fool yourself by inadvertently stumbling across misleading results - and if you are not honest about what you did, you can fool others too.

[^6]: "If you torture the data long enough, it will confess" [@good1972]

```{r salmon, fig.cap="By deliberately exploiting analytic flexibility in the processing pipeline of fMRI data, Bennet et al. (2009) were able to identify 'brain activity' in a dead Atlantic Salmon during cognitive perspective taking task.", fig.margin=TRUE}
knitr::include_graphics("images/prereg/salmon.jpeg")
```

## Exploratory and confirmatory research

But hang on a minute! Isn't it a good thing to seek out interesting results if they are there in the data? Shouldn't we "let the data speak"? The answer is yes! Examining the data from multiple angles is an important activity, sometimes referred to as "exploratory research". This is a great way to generate new hypotheses and identify unexpected patterns. But, with exploratory research you need to (a) be aware of the increased risk of bias and calibrate your confidence in the results accordingly; (2) be honest with other researchers about your analysis strategy so they are also aware of the risk of bias and can calibrate their confidence in the results accordingly. Note that "exploratory research" is not the same as p-hacking, which is dishonest because it involves withholding information.

Exploratory research can be contrasted with confirmatory research, where we 




Consider also that there are multiple ways to *explain* your results - any single result can be explained by multiple different theories (known as the Duhem-Quine problem) We might call these "explanatory degrees of freedom".

Grid image.
Means (selective reporting) motive (pressure to publish etc) opportunity (RDFs)


HARking - essentially expands the GFP.




::: {.interactive}
⌨️ Interactivity box: The perils of p-hacking “Hack your way to scientific glory” (p-hacking exercise).
:::

## Only human: Cognitive biases and pressure to polish

The chrysalis effect: when ugly truth becomes a beautiful fiction

```{r chrysalis, fig.cap="The chrysalis effect", fig.margin=TRUE}
knitr::include_graphics("images/prereg/chrysalis.png")
```

There's a storybook image of the scientist as an objective, rationale, and dispassionate arbiter of truth [@veldkamp2017]. But in reality, scientists are only human: they have egos, career ambitions, and rent to pay.
cognitive bias and extrinsic motivations

Unfortunately, the scientific ecosystem in which we do our research is tainted with bad incentives.


The allocation of funding, awards, and publication prestige is based on research findings being impressive over being right7–9. Typically, this manifests as a preference for novel, positive, and ‘statistically significant’ findings over incremental, negative, or null findings7,23–25. There is additional pressure to produce articles with concise, coherent, and compelling narratives, encouraging selective reporting of research methods and results23,24,26 in order to hide the messy realities of scientific inquiry beneath a veneer of artificial perfection27.



## Reducing bias and increasing transparency with preregistration and friends

> When not planned beforehand, data analysis can approximate a projective technique, such as the Rorschach, because the investigator can project on the data his own expectancies, desires, or biases and can pull out of the data almost any ‘finding’ he may desire.
>

> `r tufte::quote_footer('--- Theodore X. Barber [-@barber1976]')`

Other related tools e.g., Registered reports, blind/masked analysis, cross validation, sensitivity analysis (Hardwicke and Wagenmakers 2021)

```{r prereg-evidence, fig.cap="Preregistration may be effective (Kaplan)", fig.margin=TRUE}
knitr::include_graphics("images/prereg/prereg-evidence.png")
```


::: {.case-study}
🔬 Case study: tale of two RCTs (Frank 2016)
:::

## Exploratory and confirmatory research: Pregistration offers the best of both worlds


## How to preregister

- Intro to Open Science Framework as one tool for timestamping your hypotheses, different kinds of preregistration templates.

Reporting preregistered work – distinguishing exploratory and confirmatory analyses, acknowledging departures from original plan

::: {.accident-report}
⚠️ Accident report: Amending your preregistration is better than not doing it at all. 
:::

```{r reg-reports, fig.cap="Registered Reports (https://www.cos.io/initiatives/registered-reports)", fig.margin=TRUE}
knitr::include_graphics("images/prereg/registered-reports.png")
```


## other things
Preregistration of secondary data analysis (and caveats about causal inference). Not our main topic, but important. 

Barriers to adoption of preregistration. 

Limitations of the preregistration approach, especially with respect to iterative theory building (e.g., Navarro critique).

From reviewer: "A mention of what preregistration is not meant for. When teaching preregistration to new graduate students or undergraduates, I find that students often get hung up on trying to “guess” the outcome of their experiment correctly, even when they have little theoretical or empirical background for their predictions. Preregistration isn’t about testing our precognition skills, though, so I find it helpful to address this issue early on."

Why preregister? (Hardwicke and Wagenmakers 2021)

- Reduce bias – addresses the problem of researcher degrees of freedom by reducing exposure to potentially biasing information and reduces selective reporting?
- Calibrate confidence – helps to gauge risk of bias thereby enabling proper interpretation of confirmatory vs exploratory results.
- Increase transparency – it’s not a straightjacket that prevents you from doing anything else, it’s a snapshot of your current thinking
- Front-load careful thinking – forces you to sit down and be careful about your thinking, often catch conceptual issues and save time in the long-run

::: {.exercise}
P-hack your way to scientific glory!
:::

::: {.exercise}
Preregister your next experiment! 
:::

<!--chapter:end:010-prereg.Rmd-->


# (PART) Execution {-}
# Experimental strategy {#selection}

Placeholder



<!--chapter:end:011-selection.Rmd-->


# Data collection {#collection}

Placeholder


## The critical importance of piloting
## Data integrity checking
## Data collection online
## Manipulation checks
## Experimental practices, beliefs, and superstitions

<!--chapter:end:012-collection.Rmd-->


# Project management {#management}

Placeholder


## Project Management
### Organizing your project
### Versioning
### File names
## Data Management
### Save your raw data
### Document your data collection process
### Organize your data for later analysis (spreadsheet version)
### Organize your data for later analysis (software version)
### Document the format of your data
## Sharing Research Products
### What you can and can't share
### Where and how to share ("If you like it then you've gotta put a license on it")
## Chapter summary

<!--chapter:end:013-manangement.Rmd-->


# (PART) Analysis and Reporting {-}
# Visualization {#viz}

Placeholder


## Basic principles of visualization
### Show the design
### Facilitate comparison
### Maximize information, minimize ink
### ``Fix the axis labels''
## Exploratory visualization

<!--chapter:end:014-viz.Rmd-->


# Exploratory data analysis {#eda}

Placeholder


## Sensitivity Analysis
## Data exploration
## Exploratory modeling and theory-building

<!--chapter:end:015-eda.Rmd-->


# Reproducible writing {#writing}

Placeholder


## Writing 
## Reproducible manuscripts
## Publication Ethics
### Authorship
### Disclosures
### Generalizability Statements
### Post-publication Errors

<!--chapter:end:016-writing.Rmd-->


# Meta-analysis {#meta}

Placeholder


## The basics of evidence synthesis
### How *not* to synthesize evidence
### Combining results across studies using fixed-effect meta-analysis
### Limitations of fixed-effects meta-analysis
### Random-effects meta-analysis
### Reporting on heterogeneity
### Applied example
## Bias in meta-analysis
### Within-study biases
### Across-study biases
#### Applied example

<!--chapter:end:017-meta.Rmd-->

```{r include=FALSE, cache=FALSE}
library(tidyverse)
library(glue)
library(knitr)
library(shiny)
library(metafor)
require(BayesFactor)
require(papaja)

opts_chunk$set(
  message = FALSE,
  warning = FALSE,
  error = FALSE,
  comment = "#>",
  collapse = TRUE,
  cache = TRUE,
  echo = FALSE,
  cache.lazy = FALSE,
  dev = "png",
  dpi = 300,
  out.width = "\\linewidth"
)
kable <- function(...) knitr::kable(..., booktabs = TRUE, linesep = "")

set.seed(42)

.font <- "Source Sans Pro"
theme_set(theme_bw(base_size = 14, base_family = .font))
theme_update(panel.grid = ggplot2::element_blank(),
             strip.background = ggplot2::element_blank(),
             legend.key = ggplot2::element_blank(),
             panel.border = ggplot2::element_blank(),
             axis.line = ggplot2::element_line(),
             strip.text = ggplot2::element_text(face = "bold"))
.grey <- "grey70"
.refline <- "dotted"
.coef_line <- element_line(colour = .grey, size = 0.1)

.pal <- ggthemes::ptol_pal
.scale_colour_discrete <- ggthemes::scale_colour_ptol
.scale_color_discrete <- .scale_colour_discrete
.scale_fill_discrete <- ggthemes::scale_fill_ptol

.scale_colour_continuous <- viridis::scale_colour_viridis
.scale_color_continuous <- .scale_colour_continuous
.scale_fill_continuous <- viridis::scale_fill_viridis

.scale_colour_numerous <- scale_colour_discrete
.scale_color_numerous <- .scale_colour_numerous
.scale_fill_numerous <- scale_fill_discrete

# from https://bookdown.org/yihui/rmarkdown-cookbook/font-color.html
colorize <- function(x, color) {
  if (knitr::is_latex_output()) {
    sprintf("\\textcolor{%s}{%s}", color, x)
  } else if (knitr::is_html_output()) {
    sprintf("<span style='color: %s;'>%s</span>", color,
            x)
  } else x
}
```
# Conclusions {#conclusions}

::: {.learning-goals}
🍎 Learning goals: Synthesize and extend lessons from previous chapters.
:::

::: {.case-study}
🔬 Case study: How to run a study that doesn’t replicate, and how to design a study that doesn’t contribute to our knowledge. We report new empirical analysis of aggregate data from 10 years of Psych 251 (>100 replication projects), discussing empirical predictors of (non-)replicability
:::

Revisiting themes of precision, transparency, generalizability, bias-reduction

- Discuss the “crisis” narrative and reframe as one way into seeing the set of interlocking issues that keep behavioral research from contributing to cumulative theory.
- Collaboration as a way forward. Spotlight the Psychological Science Accelerator (Moshontz et al. 2018).

Concrete suggestions for building a cumulative research program

- This was a big book, and incorporating all of this advice into your research program may seem difficult or overwhelming.
- Start simple, and repeat: for building an empirical research program, you want to measure one thing well and then build on that measurement. 
- Internal replication as a critical way to check your own work. 
- Cumulativity as a key principle that you can model in your own work. 

<!--chapter:end:018-conclusions.Rmd-->


# (PART) Appendices {-}
# GitHub Tutorial {#git}

Placeholder


## Introduction {.unnumbered}
## 0. Review basic terminal commands {-}
## 1. Install git {.unnumbered}
### 1.1 Did you successfully install? {.unnumbered}
### 1.2 Other versions {.unnumbered}
### 1.3 Set your name and email address {.unnumbered}
## 2. Make a repo on GitHub, clone it to your computer {.unnumbered}
## 3. Make some commits {.unnumbered}
### 3.1 Update your README file {.unnumbered}
### 3.2 Add and commit changes to git {.unnumbered}
### 3.3 Add another file to the repo + commit it {.unnumbered}
## 4. Push your changes to GitHub {.unnumbered}
## 5. Make more changes to the repo {.unnumbered}
## 6. Rolling back to previous versions {.unnumbered}
## 7. What not to put on git {.unnumbered}
## Further Resources {.unnumbered}

<!--chapter:end:100-github.Rmd-->


# R Markdown Tutorial {#rmarkdown}

Placeholder


## Why write reproducible papers?
## Getting Started
## Structure of an R Markdown file
### Header
### Body text
### Code chunks
### Output formats
## Markdown syntax
## Headers, graphs, and tables
### Headers 
### Graphs
### Tables
### Statistics
## Writing APA-format papers
## Bibiographic management
## Collaboration 
## R Markdown: Chapter Summary

<!--chapter:end:101-rmarkdown.Rmd-->


# Tidyverse Tutorial {#tidyverse}

Placeholder


## Functions and Pipes
## Tidy data analysis
### Exploring and characterizing the dataset
### Filtering and mutating
### Standard descriptives using `summarise` and `group_by`
### More advanced combos
## Getting your data tidy
## Tidyverse: Chapter sumamry

<!--chapter:end:102-tidyverse.Rmd-->


# ggplot Tutorial {#ggplot}

Placeholder


## Exploring ggplot2 using `qplot`
## More complex with `ggplot`
## Facets
## Geoms
## Themes and plot cleanup
## Plot inheritance example
## Advanced plot exploration exercise
### Variable exploration
### Hypothesis-related exploration

<!--chapter:end:103-ggplot.Rmd-->


# Instructor's guide {#instructors}

Placeholder


## Introduction 
## Why Teach a Project-Based Course?
## Scenarios for different course layouts
### Student Level:
### Course Resources:
#### Teaching Assistants (or lack thereof)
#### Course Funding (or lack thereof)
## Logistics
### Course budget
### Course-related Institutional Review Board application
### Sample syllabus for a 10-week and 16-week version of the course

<!--chapter:end:104-instructors.Rmd-->

